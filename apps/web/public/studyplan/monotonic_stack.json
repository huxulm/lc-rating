{"title": "分享｜【算法题单】单调栈（矩形面积/贡献法/最小字典序）", "src": "https://leetcode.cn/circle/discuss/9oZFK9", "last_update": "2025-08-05T01:28:01.995050+00:00", "children": [{"title": "介绍", "summary": "<img src=\"https://pic.leetcode.cn/1711714526-rMdiIh-t3-c.png\" alt=\"单调栈题单单调栈入门单调栈题目单调栈教程单调栈视频leetcode单调栈 灵茶山艾府 灵神 灵神题单\" style=\"width: 100%;\"><br>> 他向远方望去，无法看到高山背后的矮山，只看到一座座更高的山峰。<br>推荐先做做 <a href=\"/lc-rating/list/data_structure\">数据结构题单</a> 中的「枚举右，维护左」以及第三章「栈」的基础题目后，再来刷本题单。<br>", "isLeaf": false, "children": [{"title": "一、单调栈", "summary": "", "isLeaf": false, "children": [{"title": "right[i] 是 nums[i] 右侧最近的严格大于 nums[i] 的数的下标，若不存在则为 n", "summary": "原理讲解：<a href=\"https://www.bilibili.com/video/BV1VN411J7S7/\">单调栈【基础算法精讲 26】</a><br>模板：<br>```py [sol-Python3]<br>def nearestGreater(nums: List[int]) -> Tuple[List[int], List[int]]:<br>n = len(nums)<br>left = [-1] * n<br>st = []<br>for i, x in enumerate(nums):<br>while st and nums[st[-1]] <= x:  # 如果求严格小于，改成 >=<br>st.pop()<br>if st:<br>left[i] = st[-1]<br>st.append(i)<br>right = [n] * n<br>st = []<br>for i in range(n - 1, -1, -1):<br>x = nums[i]<br>while st and nums[st[-1]] <= x:<br>st.pop()<br>if st:<br>right[i] = st[-1]<br>st.append(i)<br>return left, right<br>```<br>```java [sol-Java]<br>class Solution {<br>private int[][] nearestGreater(int[] nums) {<br>int n = nums.length;<br>// left[i] 是 nums[i] 左侧最近的严格大于 nums[i] 的数的下标，若不存在则为 -1<br>int[] left = new int[n];<br>Deque<Integer> st = new ArrayDeque<>();<br>st.push(-1); // 哨兵<br>for (int i = 0; i < n; i++) {<br>int x = nums[i];<br>while (st.size() > 1 && nums[st.peek()] <= x) { // 如果求严格小于，改成 >=<br>st.pop();<br>}<br>left[i] = st.peek();<br>st.push(i);<br>}<br>// right[i] 是 nums[i] 右侧最近的严格大于 nums[i] 的数的下标，若不存在则为 n<br>int[] right = new int[n];<br>st.clear();<br>st.push(n); // 哨兵<br>for (int i = n - 1; i >= 0; i--) {<br>int x = nums[i];<br>while (st.size() > 1 && nums[st.peek()] <= x) {<br>st.pop();<br>}<br>right[i] = st.peek();<br>st.push(i);<br>}<br>return new int[][]{left, right};<br>}<br>}<br>```<br>```cpp [sol-C++]<br>pair<vector<int>, vector<int>> nearestGreater(vector<int>& nums) {<br>int n = nums.size();<br>// left[i] 是 nums[i] 左侧最近的严格大于 nums[i] 的数的下标，若不存在则为 -1<br>vector<int> left(n);<br>vector<int> st{-1}; // 哨兵<br>for (int i = 0; i < n; i++) {<br>int x = nums[i];<br>while (st.size() > 1 && nums[st.back()] <= x) { // 如果求严格小于，改成 >=<br>st.pop_back();<br>}<br>left[i] = st.back();<br>st.push_back(i);<br>}<br>// right[i] 是 nums[i] 右侧最近的严格大于 nums[i] 的数的下标，若不存在则为 n<br>vector<int> right(n);<br>st = {n}; // 哨兵<br>for (int i = n - 1; i >= 0; i--) {<br>int x = nums[i];<br>while (st.size() > 1 && nums[st.back()] <= x) {<br>st.pop_back();<br>}<br>right[i] = st.back();<br>st.push_back(i);<br>}<br>return {left, right};<br>}<br>```<br>```go [sol-Go]<br>func nearestGreater(nums []int) ([]int, []int) {<br>n := len(nums)<br>// left[i] 是 nums[i] 左侧最近的严格大于 nums[i] 的数的下标，若不存在则为 -1<br>left := make([]int, n)<br>st := []int{-1} // 哨兵<br>for i, x := range nums {<br>for len(st) > 1 && nums[st[len(st)-1]] <= x { // 如果求严格小于，改成 >=<br>st = st[:len(st)-1]<br>}<br>left[i] = st[len(st)-1]<br>st = append(st, i)<br>}<br>// right[i] 是 nums[i] 右侧最近的严格大于 nums[i] 的数的下标，若不存在则为 n<br>right := make([]int, n)<br>st = []int{n} // 哨兵<br>for i := n - 1; i >= 0; i-- {<br>x := nums[i]<br>for len(st) > 1 && nums[st[len(st)-1]] <= x {<br>st = st[:len(st)-1]<br>}<br>right[i] = st[len(st)-1]<br>st = append(st, i)<br>}<br>return left, right<br>}<br>```<br>", "isLeaf": true, "children": [], "problems": [{"id": 739, "title": "739. 每日温度", "slug": "/daily-temperatures/", "src": "https://leetcode.cn/problems/daily-temperatures/", "solution": null, "score": null, "isPremium": false}, {"id": 1475, "title": "1475. 商品折扣后的最终价格", "slug": "/final-prices-with-a-special-discount-in-a-shop/", "src": "https://leetcode.cn/problems/final-prices-with-a-special-discount-in-a-shop/", "solution": null, "score": 1212.2606422181, "isPremium": false}, {"id": 496, "title": "496. 下一个更大元素 I", "slug": "/next-greater-element-i/", "src": "https://leetcode.cn/problems/next-greater-element-i/", "solution": null, "score": null, "isPremium": false}, {"id": 503, "title": "503. 下一个更大元素 II", "slug": "/next-greater-element-ii/", "src": "https://leetcode.cn/problems/next-greater-element-ii/", "solution": null, "score": null, "isPremium": false}, {"id": 901, "title": "901. 股票价格跨度", "slug": "/online-stock-span/", "src": "https://leetcode.cn/problems/online-stock-span/", "solution": null, "score": 1708.8735585776, "isPremium": false}, {"id": 853, "title": "853. 车队", "slug": "/car-fleet/", "src": "https://leetcode.cn/problems/car-fleet/", "solution": null, "score": 1678.1133886034, "isPremium": false}]}, {"title": "§1.2 进阶（选做）", "summary": "**思维扩展**：<br>", "isLeaf": true, "children": [], "problems": [{"id": 1019, "title": "1019. 链表中的下一个更大节点", "slug": "/next-greater-node-in-linked-list/", "src": "https://leetcode.cn/problems/next-greater-node-in-linked-list/", "solution": null, "score": 1570.8347522104, "isPremium": false}, {"id": 768, "title": "768. 最多能完成排序的块 II", "slug": "/max-chunks-to-make-sorted-ii/", "src": "https://leetcode.cn/problems/max-chunks-to-make-sorted-ii/", "solution": null, "score": 1787.6346864268, "isPremium": false}, {"id": 654, "title": "654. 最大二叉树", "slug": "/maximum-binary-tree/", "src": "https://leetcode.cn/problems/maximum-binary-tree/", "solution": null, "score": null, "isPremium": false}, {"id": 456, "title": "456. 132 模式", "slug": "/132-pattern/", "src": "https://leetcode.cn/problems/132-pattern/", "solution": null, "score": null, "isPremium": false}, {"id": 3113, "title": "3113. 边界元素是最大值的子数组数目", "slug": "/find-the-number-of-subarrays-where-boundary-elements-are-maximum/", "src": "https://leetcode.cn/problems/find-the-number-of-subarrays-where-boundary-elements-are-maximum/", "solution": null, "score": 2046.2618466463, "isPremium": false}, {"id": 2866, "title": "2866. 美丽塔 II", "slug": "/beautiful-towers-ii/", "src": "https://leetcode.cn/problems/beautiful-towers-ii/", "solution": null, "score": 2071.6322841217, "isPremium": false}, {"id": 1944, "title": "1944. 队列中可以看到的人数", "slug": "/number-of-visible-people-in-a-queue/", "src": "https://leetcode.cn/problems/number-of-visible-people-in-a-queue/", "solution": null, "score": 2104.9526046945, "isPremium": false}, {"id": 2454, "title": "2454. 下一个更大元素 IV", "slug": "/next-greater-element-iv/", "src": "https://leetcode.cn/problems/next-greater-element-iv/", "solution": null, "score": 2175.1190473433, "isPremium": false}, {"id": 1130, "title": "1130. 叶值的最小代价生成树", "slug": "/minimum-cost-tree-from-leaf-values/", "src": "https://leetcode.cn/problems/minimum-cost-tree-from-leaf-values/", "solution": null, "score": 1919.1749818083, "isPremium": false}, {"id": 2289, "title": "2289. 使数组按非递减顺序排列", "slug": "/steps-to-make-array-non-decreasing/", "src": "https://leetcode.cn/problems/steps-to-make-array-non-decreasing/", "solution": null, "score": 2481.8722909195, "isPremium": false}, {"id": 1776, "title": "1776. 车队 II", "slug": "/car-fleet-ii/", "src": "https://leetcode.cn/problems/car-fleet-ii/", "solution": null, "score": 2530.6905139914, "isPremium": false}, {"id": 2736, "title": "2736. 最大和查询", "slug": "/maximum-sum-queries/", "src": "https://leetcode.cn/problems/maximum-sum-queries/", "solution": null, "score": 2533.2830157959, "isPremium": false}, {"id": 3420, "title": "3420. 统计 K 次操作以内得到非递减子数组的数目", "slug": "/count-non-decreasing-subarrays-after-k-operations/", "src": "https://leetcode.cn/problems/count-non-decreasing-subarrays-after-k-operations/", "solution": null, "score": 2854.6879585019, "isPremium": false}, {"id": 3221, "title": "3221. 最大数组跳跃得分 II", "slug": "/maximum-array-hopping-score-ii/", "src": "https://leetcode.cn/problems/maximum-array-hopping-score-ii/", "solution": null, "score": null, "isPremium": true}, {"id": 1966, "title": "1966. 未排序数组中的可被二分搜索的数", "slug": "/binary-searchable-numbers-in-an-unsorted-array/", "src": "https://leetcode.cn/problems/binary-searchable-numbers-in-an-unsorted-array/", "solution": null, "score": null, "isPremium": true}, {"id": 2832, "title": "2832. 每个元素为最大值的最大范围", "slug": "/maximal-range-that-each-element-is-maximum-in-it/", "src": "https://leetcode.cn/problems/maximal-range-that-each-element-is-maximum-in-it/", "solution": null, "score": null, "isPremium": true}, {"id": 2282, "title": "2282. 在一个网格中可以看到的人数", "slug": "/number-of-people-that-can-be-seen-in-a-grid/", "src": "https://leetcode.cn/problems/number-of-people-that-can-be-seen-in-a-grid/", "solution": null, "score": null, "isPremium": true}, {"id": 3555, "title": "3555. 排序每个滑动窗口中最小的子数组", "slug": "/smallest-subarray-to-sort-in-every-sliding-window/", "src": "https://leetcode.cn/problems/smallest-subarray-to-sort-in-every-sliding-window/", "solution": null, "score": null, "isPremium": true}, {"id": 962, "title": "962. 最大宽度坡", "slug": "/maximum-width-ramp/", "src": "https://leetcode.cn/problems/maximum-width-ramp/", "solution": null, "score": 1607.80608595, "isPremium": false}, {"id": 3542, "title": "3542. 将所有元素变为 0 的最少操作次数", "slug": "/minimum-operations-to-convert-all-elements-to-zero/", "src": "https://leetcode.cn/problems/minimum-operations-to-convert-all-elements-to-zero/", "solution": null, "score": 1889.8158281754, "isPremium": false}, {"id": 1124, "title": "1124. 表现良好的最长时间段", "slug": "/longest-well-performing-interval/", "src": "https://leetcode.cn/problems/longest-well-performing-interval/", "solution": null, "score": 1908.3866125757, "isPremium": false}]}], "problems": []}, {"title": "二、矩形", "summary": "", "isLeaf": true, "children": [], "problems": [{"id": 84, "title": "84. 柱状图中最大的矩形", "slug": "/largest-rectangle-in-histogram/", "src": "https://leetcode.cn/problems/largest-rectangle-in-histogram/", "solution": null, "score": null, "isPremium": false}, {"id": 1793, "title": "1793. 好子数组的最大分数", "slug": "/maximum-score-of-a-good-subarray/", "src": "https://leetcode.cn/problems/maximum-score-of-a-good-subarray/", "solution": null, "score": 1945.7515607928, "isPremium": false}, {"id": 85, "title": "85. 最大矩形", "slug": "/maximal-rectangle/", "src": "https://leetcode.cn/problems/maximal-rectangle/", "solution": null, "score": null, "isPremium": false}, {"id": 221, "title": "221. 最大正方形", "slug": "/maximal-square/", "src": "https://leetcode.cn/problems/maximal-square/", "solution": null, "score": null, "isPremium": false}, {"id": 42, "title": "42. 接雨水", "slug": "/trapping-rain-water/", "src": "https://leetcode.cn/problems/trapping-rain-water/", "solution": null, "score": null, "isPremium": false}, {"id": 1504, "title": "1504. 统计全 1 子矩形", "slug": "/count-submatrices-with-all-ones/", "src": "https://leetcode.cn/problems/count-submatrices-with-all-ones/", "solution": null, "score": 1845.0428731248, "isPremium": false}, {"id": 1277, "title": "1277. 统计全为 1 的正方形子矩阵", "slug": "/count-square-submatrices-with-all-ones/", "src": "https://leetcode.cn/problems/count-square-submatrices-with-all-ones/", "solution": null, "score": 1613.0429766636, "isPremium": false}, {"id": 755, "title": "755. 倒水", "slug": "/pour-water/", "src": "https://leetcode.cn/problems/pour-water/", "solution": null, "score": 1832.2280384591, "isPremium": true}]}, {"title": "三、贡献法", "summary": "**思维扩展**：<br>", "isLeaf": true, "children": [], "problems": [{"id": 907, "title": "907. 子数组的最小值之和", "slug": "/sum-of-subarray-minimums/", "src": "https://leetcode.cn/problems/sum-of-subarray-minimums/", "solution": null, "score": 1975.5726300727, "isPremium": false}, {"id": 2104, "title": "2104. 子数组范围和（最大值-最小值）", "slug": "/sum-of-subarray-ranges/", "src": "https://leetcode.cn/problems/sum-of-subarray-ranges/", "solution": null, "score": 1504.2133321504, "isPremium": false}, {"id": 1856, "title": "1856. 子数组最小乘积的最大值", "slug": "/maximum-subarray-min-product/", "src": "https://leetcode.cn/problems/maximum-subarray-min-product/", "solution": null, "score": 2051.0879431258, "isPremium": false}, {"id": 2818, "title": "2818. 操作使得分最大", "slug": "/apply-operations-to-maximize-score/", "src": "https://leetcode.cn/problems/apply-operations-to-maximize-score/", "solution": null, "score": 2396.6770372863, "isPremium": false}, {"id": 2281, "title": "2281. 巫师的总力量和（最小值×和）", "slug": "/sum-of-total-strength-of-wizards/", "src": "https://leetcode.cn/problems/sum-of-total-strength-of-wizards/", "solution": null, "score": 2621.1208072273, "isPremium": false}, {"id": 3430, "title": "3430. 最多 K 个元素的子数组的最值之和", "slug": "/maximum-and-minimum-sums-of-at-most-size-k-subarrays/", "src": "https://leetcode.cn/problems/maximum-and-minimum-sums-of-at-most-size-k-subarrays/", "solution": null, "score": 2644.9681021386, "isPremium": false}, {"id": 3359, "title": "3359. 查找最大元素不超过 K 的有序子矩阵", "slug": "/find-sorted-submatrices-with-maximum-element-at-most-k/", "src": "https://leetcode.cn/problems/find-sorted-submatrices-with-maximum-element-at-most-k/", "solution": null, "score": null, "isPremium": true}, {"id": 2334, "title": "2334. 元素值大于变化阈值的子数组", "slug": "/subarray-with-elements-greater-than-varying-threshold/", "src": "https://leetcode.cn/problems/subarray-with-elements-greater-than-varying-threshold/", "solution": null, "score": 2381.2160234811, "isPremium": false}, {"id": 2962, "title": "2962. 统计最大元素出现至少 K 次的子数组·我的题解", "slug": "/count-subarrays-where-max-element-appears-at-least-k-times/solutions/2560940/hua-dong-chuang-kou-fu-ti-dan-pythonjava-xvwg/", "src": "https://leetcode.cn/problems/count-subarrays-where-max-element-appears-at-least-k-times/solutions/2560940/hua-dong-chuang-kou-fu-ti-dan-pythonjava-xvwg/", "solution": null, "score": 1700.8505554268, "isPremium": false}]}, {"title": "四、最小字典序", "summary": "", "isLeaf": true, "children": [], "problems": [{"id": 402, "title": "402. 移掉 K 位数字", "slug": "/remove-k-digits/", "src": "https://leetcode.cn/problems/remove-k-digits/", "solution": null, "score": null, "isPremium": false}, {"id": 1673, "title": "1673. 找出最具竞争力的子序列", "slug": "/find-the-most-competitive-subsequence/", "src": "https://leetcode.cn/problems/find-the-most-competitive-subsequence/", "solution": null, "score": 1802.2256875356, "isPremium": false}, {"id": 316, "title": "316. 去除重复字母", "slug": "/remove-duplicate-letters/", "src": "https://leetcode.cn/problems/remove-duplicate-letters/", "solution": null, "score": null, "isPremium": false}, {"id": "316 扩展：重复个数不超过 limit", "title": "316 扩展：重复个数不超过 limit", "slug": null, "src": "https://leetcode.cn/contest/tianchi2022/problems/ev2bru/", "solution": null, "score": null, "isPremium": false}, {"id": 1081, "title": "1081. 不同字符的最小子序列", "slug": "/smallest-subsequence-of-distinct-characters/", "src": "https://leetcode.cn/problems/smallest-subsequence-of-distinct-characters/", "solution": null, "score": 2184.5241011615, "isPremium": false}, {"id": 321, "title": "321. 拼接最大数", "slug": "/create-maximum-number/", "src": "https://leetcode.cn/problems/create-maximum-number/", "solution": null, "score": null, "isPremium": false}, {"id": 2030, "title": "2030. 含特定字母的最小子序列", "slug": "/smallest-k-length-subsequence-with-occurrences-of-a-letter/", "src": "https://leetcode.cn/problems/smallest-k-length-subsequence-with-occurrences-of-a-letter/", "solution": null, "score": 2561.7794931859, "isPremium": false}]}, {"title": "算法题单", "summary": "<a href=\"https://leetcode.cn/circle/discuss/RvFUtj/\">如何科学刷题？</a><br>1. <a href=\"/lc-rating/list/sliding_window\">滑动窗口与双指针（定长/不定长/单序列/双序列/三指针/分组循环）</a><br>2. <a href=\"/lc-rating/list/binary_search\">二分算法（二分答案/最小化最大值/最大化最小值/第K小）</a><br>3. <a href=\"/lc-rating/list/monotonic_stack\">单调栈（基础/矩形面积/贡献法/最小字典序）</a><br>4. <a href=\"/lc-rating/list/grid\">网格图（DFS/BFS/综合应用）</a><br>5. <a href=\"/lc-rating/list/bitwise_operations\">位运算（基础/性质/拆位/试填/恒等式/思维）</a><br>6. <a href=\"/lc-rating/list/graph\">图论算法（DFS/BFS/拓扑排序/基环树/最短路/最小生成树/网络流）</a><br>7. <a href=\"/lc-rating/list/dynamic_programming\">动态规划（入门/背包/划分/状态机/区间/状压/数位/数据结构优化/树形/博弈/概率期望）</a><br>8. <a href=\"/lc-rating/list/data_structure\">常用数据结构（前缀和/差分/栈/队列/堆/字典树/并查集/树状数组/线段树）</a><br>9. <a href=\"/lc-rating/list/math\">数学算法（数论/组合/概率期望/博弈/计算几何/随机算法）</a><br>10. <a href=\"/lc-rating/list/greedy\">贪心与思维（基本贪心策略/反悔/区间/字典序/数学/思维/脑筋急转弯/构造）</a><br>11. <a href=\"/lc-rating/list/trees\">链表、二叉树与回溯（前后指针/快慢指针/DFS/BFS/直径/LCA/一般树）</a><br>12. <a href=\"/lc-rating/list/string\">字符串（KMP/Z函数/Manacher/字符串哈希/AC自动机/后缀数组/子序列自动机）</a><br><a href=\"https://github.com/EndlessCheng/codeforces-go/blob/master/leetcode/SOLUTIONS.md\">我的题解精选（已分类）</a><br>欢迎关注 <a href=\"https://space.bilibili.com/206214\">B站@灵茶山艾府</a><br>如果你发现有题目可以补充进来，欢迎评论反馈。<br>", "isLeaf": false, "children": [], "problems": []}], "problems": []}]}